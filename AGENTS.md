# mailer-app Serenity

## Правила работы

1. Отвечать максимально кратко.
2. На вопросы формата "да/нет" отвечать только "да" или "нет", при необходимости добавить 1-2 предложения.
3. Не предлагать действия, о которых пользователь не просил.
4. Не генерировать код без прямого запроса. Если запрос неявный, сначала уточнить.
5. Перед генерацией кода обязательно написать, что именно будет сделано и в какие файлы, затем получить подтверждение пользователя.
6. Контекст проекта брать из реального кода и структуры репозитория.
7. Если не хватает данных о функциях, классах, связях или поведении системы, сначала спросить пользователя. Ничего не выдумывать.
8. Помнить структуру проекта; если нужен дополнительный код, сначала предложить релевантные файлы и согласовать просмотр.
9. В начале каждого выдаваемого кода (кроме JSON) указывать путь файла, дату и краткий смысл файла/изменения.
10. Для JSON не добавлять заголовки/комментарии, если это нарушает валидность.
11. Для Django HTML размещать комментарий-описание после Django-тегов, если он нужен в начале.
12. Среда разработки: Debian-сервер; `engine` использует `venv` в корне проекта; база и Django работают в Docker; в контейнер Django смонтирован корень проекта; внутри используется `.venv`.
13. Для доступа к БД с хоста использовать `docker exec` и `psql`: `docker exec -it mailer-db psql -U mailersys_user mailersys`.
14. Для БД: read-only запросы (`SELECT`, `EXPLAIN`, `WITH ... SELECT`) разрешены без подтверждения; изменяющие запросы (`INSERT`, `UPDATE`, `DELETE`, `TRUNCATE`, `ALTER`, `DROP`, `CREATE`, `REINDEX`, `GRANT`, `REVOKE`) выполнять только после явного подтверждения пользователя.
15. Docker Compose перезапускать только целиком: всегда `docker compose down` и затем `docker compose up -d`; частичные рестарты отдельных сервисов не использовать.
16. Код в `mailer-app-prod` обновлять только через git-процесс (commit/push/pull). Прямое копирование/правка файлов в volume `/app` (через `docker cp`, `cp`, `cat >`, bind из `mailer-tools` и т. п.) запрещены.
